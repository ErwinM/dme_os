8000 : 007d     |     ldi bp, 15 ; cntr
8002 : 1ff9     |     ldi r1, -1 ; one less because loop contains add 1
8004 : 007a     |     ldi r2, 15 ; one less because loop contains add 1; pg 16 = 0x8000
     :          | mappages_boot:
8006 : a212     |     addi r2, r2, 1
8008 : a209     |     addi r1, r1, 1
800a : db06     |     shl r3, r1, 8
800c : 001c     |     ldi r4, 3
800e : 9ae3     |     or r3, r3, r4
8010 : d098     |     wpte r2, r3
8012 : aded     |     addskpi.z bp, bp, -1
8014 : 3ff0     |     br mappages_boot
8016 : 00f9     |     ldi r1, 31
8018 : 081a     |     ld16 r2, 0xf03
801a : bc1d     |     
801c : d050     |     wpte r1, r2
801e : 001b     |     ldi r3, 3
8020 : d018     |     wpte r0, r3
8022 : d400     |     wptb r0
8024 : cc01     |     lcr r1
8026 : a889     |     ori r1, r1, 4
8028 : ce40     |     wcr r1
802a : 0ea1     |     la16 r1, _alltraps
802c : bd0c     |     
802e : d801     |     wivec r1
8030 : 0801     |     la16 r1, 0xff00
8032 : bdfc     |     
8034 : 9446     |     mov sp, r1
8036 : 02f2     |     la16 r2, _kmain
8038 : bd11     |     
803a : a279     |     addi r1, pc, 2
803c : c202     |     br.r r2
803e : fe00     |     hlt
     :          | _printint:
8040 : be01     |     push	r1
8042 : be05     |     push	bp
8044 : 9585     |     mov	bp, sp
8046 : 00e4     |     ldi	r4, 28
8048 : 97a6     |     sub	sp, sp, r4
804a : 8822     |     ldw	r3,8(bp)
804c : 9cc1     |     skip.ne	r3,r0
804e : 2026     |     br	L3_console
8050 : 8812     |     ldw	r3,4(bp)
8052 : 9cc2     |     skip.lt r3, r0
8054 : 200a     |     br L6_console
8056 : 000c     |     ld16	r4, 1
8058 : 8dab     |     stw	-22(bp),r4
805a : 0314     |     la16	r4,L7_console
805c : bd03     |     
805e : c204     |     br.r r4
     :          | L6_console:
8060 : 91a8     |     stw	-22(bp),r0
     :          | L7_console:
8062 : 89ab     |     ldw	r4,-22(bp)
8064 : 8c23     |     stw	8(bp),r4
8066 : 9d01     |     skip.ne	r4,r0
8068 : 200c     |     br	L3_console
806a : 8813     |     ldw	r4,4(bp)
806c : 9624     |     sub	r4,r0,r4
806e : 8df3     |     stw	-4(bp),r4
8070 : 03d4     |     la16	r4,L4_console
8072 : bd03     |     
8074 : c204     |     br.r r4
     :          | L3_console:
8076 : 8813     |     ldw	r4,4(bp)
8078 : 8df3     |     stw	-4(bp),r4
     :          | L4_console:
807a : 91f8     |     stw	-2(bp),r0
     :          | L8_console:
807c : 89fb     |     ldw	r4,-2(bp)
807e : a223     |     addi	r3,r4,1
8080 : 8dfa     |     stw	-2(bp),r3
8082 : 1f63     |     ldi	r3, -20
8084 : 94eb     |     add	r3, r3, bp
8086 : 951c     |     add	r4,r4,r3
8088 : 8d93     |     stw	-28(bp),r4
808a : 89f2     |     ldw	r3,-4(bp)
808c : 8da2     |     stw	-24(bp),r3
808e : 8819     |     ldw	r2,6(bp)
8090 : 8d99     |     stw	-26(bp),r2
8092 : be03     |     push r3
8094 : be02     |     push r2
8096 : a279     |     addi r1, pc, 2
8098 : 2844     |     br _mod
809a : 0af4     |     la16	r4,L2_console
809c : bd13     |     
809e : 9464     |     add	r4,r1,r4
80a0 : b224     |     ldb	r4,r0(r4)
80a2 : 8992     |     ldw	r3,-28(bp)
80a4 : b61c     |     stb	r0(r3),r4
     :          | L9_console:
80a6 : 89f3     |     ldw	r4,-4(bp)
80a8 : 881a     |     ldw	r3,6(bp)
80aa : be04     |     push r4
80ac : be03     |     push r3
80ae : a279     |     addi r1, pc, 2
80b0 : 27ec     |     br _div
80b2 : 8df0     |     stw	-4(bp),r1
80b4 : 9c40     |     skip.eq r1,r0
80b6 : 3fc4     |     br L8_console
80b8 : 8823     |     ldw	r4,8(bp)
80ba : 9d01     |     skip.ne	r4,r0
80bc : 202e     |     br	L1_console4_console
80be : 89fb     |     ldw	r4,-2(bp)
80c0 : a223     |     addi	r3,r4,1
80c2 : 8dfa     |     stw	-2(bp),r3
80c4 : 1f63     |     ldi	r3, -20
80c6 : 94eb     |     add	r3, r3, bp
80c8 : 951c     |     add	r4,r4,r3
80ca : 016b     |     ld16	r3, 45
80cc : b623     |     stb	r0(r4),r3
80ce : 0764     |     la16	r4,L1_console4_console
80d0 : bd03     |     
80d2 : c204     |     br.r r4
     :          | L1_console3_console:
80d4 : 89fb     |     ldw	r4,-2(bp)
80d6 : 1f63     |     ldi	r3, -20
80d8 : 94eb     |     add	r3, r3, bp
80da : 951c     |     add	r4,r4,r3
80dc : b224     |     ldb	r4,r0(r4)
80de : be04     |     push	r4
80e0 : 0342     |     la16	r2,_putc
80e2 : bd05     |     
80e4 : a279     |     addi	r1,pc,2
80e6 : c202     |     br.r	r2
80e8 : 0012     |     ldi	r2,2
80ea : 9596     |     add	sp,sp,r2
     :          | L1_console4_console:
80ec : 89fb     |     ldw	r4,-2(bp)
80ee : a424     |     subi	r4,r4,1
80f0 : 8dfb     |     stw	-2(bp),r4
80f2 : 9d02     |     skip.lt r4, r0
80f4 : 3fde     |     br L1_console3_console
     :          | L1_console:
80f6 : 9546     |     mov	sp, bp
80f8 : c005     |     pop	bp
80fa : c007     |     pop	pc
     :          | _kprintf:
80fc : be01     |     push	r1
80fe : be05     |     push	bp
8100 : 9585     |     mov	bp, sp
8102 : 0044     |     ldi	r4, 8
8104 : 97a6     |     sub	sp, sp, r4
8106 : 0034     |     ldi	r4, 6
8108 : 952c     |     add	r4, r4, bp
810a : 8de3     |     stw	-8(bp),r4
810c : 91e8     |     stw	-6(bp),r0
810e : 0284     |     la16	r4,L2_console1
8110 : bd07     |     
8112 : c204     |     br.r r4
     :          | L1_console8:
8114 : 89fb     |     ldw	r4,-2(bp)
8116 : 012b     |     ld16	r3, 37
8118 : 9d19     |     skip.ne	r4,r3
811a : 2016     |     br	L2_console2
811c : 89fb     |     ldw	r4,-2(bp)
811e : be04     |     push	r4
8120 : 0342     |     la16	r2,_putc
8122 : bd05     |     
8124 : a279     |     addi	r1,pc,2
8126 : c202     |     br.r	r2
8128 : 0012     |     ldi	r2,2
812a : 9596     |     add	sp,sp,r2
812c : 0254     |     la16	r4,L1_console9
812e : bd07     |     
8130 : c204     |     br.r r4
     :          | L2_console2:
8132 : 89eb     |     ldw	r4,-6(bp)
8134 : a224     |     addi	r4,r4,1
8136 : 8deb     |     stw	-6(bp),r4
8138 : 8812     |     ldw	r3,4(bp)
813a : 951c     |     add	r4,r4,r3
813c : b224     |     ldb	r4,r0(r4)
813e : 07fb     |     ld16	r3, 255
8140 : 991c     |     and	r4,r4,r3
8142 : 8dfb     |     stw	-2(bp),r4
8144 : 89fb     |     ldw	r4,-2(bp)
8146 : 9d00     |     skip.eq r4,r0
8148 : 2006     |     br L2_console4
814a : 0314     |     la16	r4,L2_console0
814c : bd07     |     
814e : c204     |     br.r r4
     :          | L2_console4:
8150 : 89fb     |     ldw	r4,-2(bp)
8152 : 0343     |     ld16	r3, 104
8154 : 9d19     |     skip.ne	r4,r3
8156 : 205e     |     br	L2_console9
8158 : 9d1b     |     skip.lte	r4,r3
815a : 201a     |     br	L4_console0
     :          | L3_console9:
815c : 89fb     |     ldw	r4,-2(bp)
815e : 012b     |     ld16	r3, 37
8160 : 9d19     |     skip.ne	r4,r3
8162 : 20b0     |     br	L3_console8
8164 : 9d1d     |     skip.gte	r4,r3
8166 : 20c2     |     br	L2_console6
     :          | L4_console1:
8168 : 89fb     |     ldw	r4,-2(bp)
816a : 0323     |     ld16	r3, 100
816c : 9d19     |     skip.ne	r4,r3
816e : 2026     |     br	L2_console8
8170 : 0154     |     la16	r4,L2_console6
8172 : bd07     |     
8174 : c204     |     br.r r4
     :          | L4_console0:
8176 : 89fb     |     ldw	r4,-2(bp)
8178 : 0383     |     ld16	r3, 112
817a : 9d19     |     skip.ne	r4,r3
817c : 2038     |     br	L2_console9
817e : 039a     |     ld16	r2, 115
8180 : 9d11     |     skip.ne	r4,r2
8182 : 2050     |     br	L3_console0
8184 : 9d1d     |     skip.gte	r4,r3
8186 : 20a2     |     br	L2_console6
     :          | L4_console2:
8188 : 89fb     |     ldw	r4,-2(bp)
818a : 03c3     |     ld16	r3, 120
818c : 9d19     |     skip.ne	r4,r3
818e : 2026     |     br	L2_console9
8190 : 0154     |     la16	r4,L2_console6
8192 : bd07     |     
8194 : c204     |     br.r r4
     :          | L2_console8:
8196 : 000c     |     ld16	r4, 1
8198 : be04     |     push	r4
819a : 0054     |     ld16	r4, 10
819c : be04     |     push	r4
819e : 89e3     |     ldw	r4,-8(bp)
81a0 : a263     |     addi	r3,r4,2
81a2 : 8de2     |     stw	-8(bp),r3
81a4 : b024     |     ldw	r4,r0(r4)
81a6 : be04     |     push	r4
81a8 : 0202     |     la16	r2,_printint ; jaddr
81aa : bd01     |     
81ac : a279     |     addi	r1,pc,2
81ae : c202     |     br.r	r2
81b0 : 0254     |     la16	r4,L2_console7
81b2 : bd07     |     
81b4 : c204     |     br.r r4
     :          | L2_console9:
81b6 : be00     |     push	r0
81b8 : 0084     |     ld16	r4, 16
81ba : be04     |     push	r4
81bc : 89e3     |     ldw	r4,-8(bp)
81be : a263     |     addi	r3,r4,2
81c0 : 8de2     |     stw	-8(bp),r3
81c2 : b024     |     ldw	r4,r0(r4)
81c4 : be04     |     push	r4
81c6 : 0202     |     la16	r2,_printint ; jaddr
81c8 : bd01     |     
81ca : a279     |     addi	r1,pc,2
81cc : c202     |     br.r	r2
81ce : 0254     |     la16	r4,L2_console7
81d0 : bd07     |     
81d2 : c204     |     br.r r4
     :          | L3_console0:
81d4 : 89e3     |     ldw	r4,-8(bp)
81d6 : a263     |     addi	r3,r4,2
81d8 : 8de2     |     stw	-8(bp),r3
81da : b024     |     ldw	r4,r0(r4)
81dc : 8df3     |     stw	-4(bp),r4
81de : 9d00     |     skip.eq r4,r0
81e0 : 2024     |     br L3_console7
81e2 : 0b7c     |     la16	r4,L3_console3
81e4 : bd13     |     
81e6 : 8df3     |     stw	-4(bp),r4
81e8 : 0034     |     la16	r4,L3_console7
81ea : bd07     |     
81ec : c204     |     br.r r4
     :          | L3_console4:
81ee : 89f3     |     ldw	r4,-4(bp)
81f0 : b224     |     ldb	r4,r0(r4)
81f2 : be04     |     push	r4
81f4 : 0342     |     la16	r2,_putc
81f6 : bd05     |     
81f8 : a279     |     addi	r1,pc,2
81fa : c202     |     br.r	r2
81fc : 0012     |     ldi	r2,2
81fe : 9596     |     add	sp,sp,r2
     :          | L3_console5:
8200 : 89f3     |     ldw	r4,-4(bp)
8202 : a224     |     addi	r4,r4,1
8204 : 8df3     |     stw	-4(bp),r4
     :          | L3_console7:
8206 : 89f3     |     ldw	r4,-4(bp)
8208 : b224     |     ldb	r4,r0(r4)
820a : 9d00     |     skip.eq r4,r0
820c : 3fe0     |     br L3_console4
820e : 0254     |     la16	r4,L2_console7
8210 : bd07     |     
8212 : c204     |     br.r r4
     :          | L3_console8:
8214 : 012c     |     ld16	r4, 37
8216 : be04     |     push	r4
8218 : 0342     |     la16	r2,_putc
821a : bd05     |     
821c : a279     |     addi	r1,pc,2
821e : c202     |     br.r	r2
8220 : 0012     |     ldi	r2,2
8222 : 9596     |     add	sp,sp,r2
8224 : 0254     |     la16	r4,L2_console7
8226 : bd07     |     
8228 : c204     |     br.r r4
     :          | L2_console6:
822a : 012c     |     ld16	r4, 37
822c : be04     |     push	r4
822e : 0342     |     la16	r2,_putc
8230 : bd05     |     
8232 : a279     |     addi	r1,pc,2
8234 : c202     |     br.r	r2
8236 : 0012     |     ldi	r2,2
8238 : 9596     |     add	sp,sp,r2
823a : 89fb     |     ldw	r4,-2(bp)
823c : be04     |     push	r4
823e : 0342     |     la16	r2,_putc
8240 : bd05     |     
8242 : a279     |     addi	r1,pc,2
8244 : c202     |     br.r	r2
8246 : 0012     |     ldi	r2,2
8248 : 9596     |     add	sp,sp,r2
     :          | L2_console7:
824a : 89eb     |     ldw	r4,-6(bp)
824c : a224     |     addi	r4,r4,1
824e : 8deb     |     stw	-6(bp),r4
     :          | L2_console1:
8250 : 89eb     |     ldw	r4,-6(bp)
8252 : 8812     |     ldw	r3,4(bp)
8254 : 951c     |     add	r4,r4,r3
8256 : b224     |     ldb	r4,r0(r4)
8258 : 07fb     |     ld16	r3, 255
825a : 991c     |     and	r4,r4,r3
825c : 8dfb     |     stw	-2(bp),r4
825e : 9d00     |     skip.eq r4,r0
8260 : 3eb2     |     br L1_console8
     :          | L2_console0:
8262 : 9546     |     mov	sp, bp
8264 : c005     |     pop	bp
8266 : c007     |     pop	pc
     :          | _putc:
8268 : be01     |     push r1
826a : be05     |     push bp
826c : 9585     |     mov bp, sp
826e : 0c84     |     la16 r4, 0xff90
8270 : bdff     |     
     :          | check_tx_free_uart:
8272 : 0029     |     ldi r1, 5
8274 : 9461     |     add r1, r1, r4
8276 : b009     |     ldw r1, r0(r1)
8278 : 0302     |     ldi r2, 0x60
827a : 9851     |     and r1, r1, r2
827c : 9c88     |     skip.eq r2, r1
827e : 3ff2     |     br check_tx_free_uart
8280 : a2a9     |     addi r1, bp, 4
8282 : b00b     |     ldw r3, r0(r1)
8284 : b623     |     stb r0(r4), r3
8286 : c005     |     pop	bp
8288 : c007     |     pop	pc
     :          | _inituart:
828a : be01     |     push r1
828c : be05     |     push bp
828e : 0c81     |     la16 r1, 0xff90
8290 : bdfc     |     
8292 : 9445     |     mov r5, r1
8294 : 9401     |     mov r1, r0
8296 : 8c04     |     stw 1(bp), r1   ; port + 1 0x00 - disable all interrupts
8298 : 0401     |     ldi r1, 0x80
829a : 8c0c     |     stw 3(bp), r1   ; port + 3 0x80 enable dlab
829c : 01a1     |     ldi r1, 52
829e : 8c00     |     stw 0(bp), r1		; port + 0 set divisor to 1 LSB
82a0 : 0001     |     ldi r1, 0
82a2 : 8c04     |     stw 1(bp), r1		; port + 1 set divisor to 1 MSB
82a4 : 0019     |     ldi r1, 3
82a6 : 8c0c     |     stw 3(bp), r1		; port + 3 set LCR - validate
82a8 : c005     |     pop	bp
82aa : c007     |     pop	pc; MEMSET (char *dst, int c, uint n)
     :          | _memset:
82ac : be01     |     push	r1
82ae : be05     |     push	bp
82b0 : 9585     |     mov	bp, sp
82b2 : 8810     |     ldw	r1,4(bp) ; load dst
82b4 : 8819     |     ldw	r2,6(bp) ; load c
82b6 : 8822     |     ldw	r3,8(bp) ; load n
82b8 : a61c     |     andi r4,r3,1
82ba : 9d00     |     skip.eq r4, r0
82bc : 2018     |     br _stosb
82be : a60c     |     andi r4, r1, 1
82c0 : 9d00     |     skip.eq r4, r0
82c2 : 2012     |     br _stosb
82c4 : db0b     |     shl r4, r2, 8
82c6 : 9aa2     |     or r2, r2, r4
82c8 : a45b     |     subi r3, r3, 2
     :          | _stoswL1:
82ca : 945c     |     add	r4,r1,r3
82cc : b422     |     stw	r0(r4),r2
82ce : ad9b     |     addskpi.z r3, r3, -2
82d0 : 3ff8     |     br _stoswL1
82d2 : b40a     |     stw r0(r1), r2
82d4 : 200c     |     br _memsetend
     :          | _stosb:
82d6 : a41b     |     subi r3, r3, 1
     :          | _stosbL1:
82d8 : 945c     |     add	r4,r1,r3
82da : b622     |     stb	r0(r4),r2
82dc : addb     |     addskpi.z r3, r3, -1
82de : 3ff8     |     br _stosbL1
82e0 : b60a     |     stb r0(r1), r2
     :          | _memsetend:
82e2 : c005     |     pop	bp
82e4 : c007     |     pop	pc
     :          | _halt:
82e6 : fe00     |     hlt
     :          | _breek:
82e8 : be01     |     push r1
82ea : ca00     |     brk
82ec : c007     |     pop pc
     :          | _writepte:
82ee : be01     |     push r1
82f0 : be05     |     push bp
82f2 : 9585     |     mov bp, sp
82f4 : 8810     |     ldw r1, 4(bp)
82f6 : 8819     |     ldw r2, 6(bp)
82f8 : d050     |     wpte r1, r2
82fa : c005     |     pop bp
82fc : c007     |     pop pc
     :          | _switchptb:
82fe : be01     |     push r1
8300 : be05     |     push bp
8302 : 9585     |     mov bp, sp
8304 : 8810     |     ldw r1, 4(bp)
8306 : d440     |     wptb r1
8308 : c005     |     pop bp
830a : c007     |     pop pc
     :          | _clearptb:
830c : be01     |     push r1
830e : be05     |     push bp
8310 : 9585     |     mov bp, sp
8312 : 8810     |     ldw r1, 4(bp)
8314 : 0102     |     ldi r2, 32 ; one extra cause we sub 1 in loop
8316 : 9452     |     add r2, r1, r2
     :          | _clearptbL1:
8318 : a412     |     subi r2, r2, 1
831a : d080     |     wpte r2, 0
831c : 9c88     |     skip.eq r2, r1
831e : 3ff8     |     br _clearptbL1
8320 : c005     |     pop bp
8322 : c007     |     pop pc
     :          | _memmove:
8324 : be01     |     push	r1
8326 : be05     |     push	bp
8328 : 9585     |     mov	bp, sp
832a : 8813     |     ldw	r4,4(bp)    ; dst
832c : 881a     |     ldw	r3,6(bp)    ; src
832e : 8821     |     ldw	r2,8(bp)    ; n
8330 : 9514     |     add	r4,r4,r2
8332 : 94d3     |     add	r3,r3,r2
8334 : 200a     |     br _memmoveL3
     :          | _memmoveL2:
8336 : a412     |     subi	r2,r2,1
8338 : a3db     |     addi	r3,r3,-1
833a : a3e4     |     addi	r4,r4,-1
833c : b219     |     ldb	r1,r0(r3)
833e : b621     |     stb	r0(r4),r1
     :          | _memmoveL3:
8340 : 9c80     |     skip.eq r2,r0
8342 : 3ff2     |     br _memmoveL2
8344 : 94c1     |     mov	r1,r3
8346 : 9546     |     mov	sp, bp
8348 : c005     |     pop	bp
834a : c007     |     pop	pc;	DME assembly file, generated by lcc 4.2
     :          | _initkmem:
834c : be01     |     push	r1
834e : be05     |     push	bp
8350 : 9585     |     mov	bp, sp
8352 : 0014     |     ldi	r4, 2
8354 : 97a6     |     sub	sp, sp, r4
8356 : 91f8     |     stw	-2(bp),r0
     :          | L2_kalloc:
8358 : 89fb     |     ldw	r4,-2(bp)
835a : da33     |     shl	r4, r4, 1 ; [via index]
835c : 0573     |     la16	r3,_pframe
835e : bd16     |     
8360 : 0ffa     |     ld16	r2, 0xffff
8362 : bdfd     |     
8364 : b51a     |     stw	r4(r3),r2
     :          | L3_kalloc:
8366 : 89fb     |     ldw	r4,-2(bp)
8368 : a224     |     addi	r4,r4,1
836a : 8dfb     |     stw	-2(bp),r4
836c : 89fb     |     ldw	r4,-2(bp)
836e : 007b     |     ld16	r3, 15
8370 : 9d1c     |     skip.gt	r4,r3
8372 : 3fe4     |     br	L2_kalloc
8374 : 0574     |     la16	r4,_pframe
8376 : bd17     |     
8378 : b420     |     stw	r0(r4),r0
     :          | L1_kalloc:
837a : 9546     |     mov	sp, bp
837c : c005     |     pop	bp
837e : c007     |     pop	pc
     :          | _findfreepg:
8380 : be01     |     push	r1
8382 : be05     |     push	bp
8384 : 9585     |     mov	bp, sp
8386 : 0034     |     ldi	r4, 6
8388 : 97a6     |     sub	sp, sp, r4
838a : 91e8     |     stw	-6(bp),r0
     :          | L7_kalloc:
838c : 89eb     |     ldw	r4,-6(bp)
838e : da33     |     shl	r4, r4, 1 ; [via index]
8390 : 0573     |     la16	r3,_pframe
8392 : bd16     |     
8394 : b11c     |     ldw	r4,r4(r3)
8396 : 9d00     |     skip.eq r4,r0
8398 : 2006     |     br L1_kalloc1
839a : 0ef4     |     la16	r4,L8_kalloc
839c : bd07     |     
839e : c204     |     br.r r4
     :          | L1_kalloc1:
83a0 : 007c     |     ld16	r4, 15
83a2 : 8dfb     |     stw	-2(bp),r4
     :          | L1_kalloc3:
83a4 : 000c     |     ld16	r4, 1
83a6 : 89fa     |     ldw	r3,-2(bp)
83a8 : df1c     |     shl.r	r4, r4, r3
83aa : 8df3     |     stw	-4(bp),r4
83ac : 89f3     |     ldw	r4,-4(bp)
83ae : 89ea     |     ldw	r3,-6(bp)
83b0 : da2e     |     shl	r3, r3, 1 ; [via index]
83b2 : 0572     |     la16	r2,_pframe
83b4 : bd15     |     
83b6 : b0d3     |     ldw	r3,r3(r2)
83b8 : 991c     |     and	r4,r4,r3
83ba : 9d01     |     skip.ne	r4,r0
83bc : 2014     |     br	L1_kalloc7
83be : 89eb     |     ldw	r4,-6(bp)
83c0 : da93     |     shl	r4, r4, 4
83c2 : 007b     |     ld16	r3, 15
83c4 : 89f9     |     ldw	r2,-2(bp)
83c6 : 96d3     |     sub	r3,r3,r2
83c8 : 951c     |     add	r4,r4,r3
83ca : 9501     |     mov	r1,r4
83cc : 0004     |     la16	r4,L6_kalloc
83ce : bd0b     |     
83d0 : c204     |     br.r r4
     :          | L1_kalloc7:
83d2 : 89fb     |     ldw	r4,-2(bp)
83d4 : a424     |     subi	r4,r4,1
83d6 : 8dfb     |     stw	-2(bp),r4
83d8 : 89fb     |     ldw	r4,-2(bp)
83da : 9d02     |     skip.lt r4, r0
83dc : 3fc6     |     br L1_kalloc3
     :          | L8_kalloc:
83de : 89eb     |     ldw	r4,-6(bp)
83e0 : a224     |     addi	r4,r4,1
83e2 : 8deb     |     stw	-6(bp),r4
83e4 : 89eb     |     ldw	r4,-6(bp)
83e6 : 0083     |     ld16	r3, 16
83e8 : 9d1c     |     skip.gt	r4,r3
83ea : 3fa0     |     br	L7_kalloc
83ec : 0c94     |     la16	r4,L1_kalloc9
83ee : bd13     |     
83f0 : be04     |     push	r4
83f2 : 07e2     |     la16	r2,_kprintf
83f4 : bd01     |     
83f6 : a279     |     addi	r1,pc,2
83f8 : c202     |     br.r	r2
83fa : 0012     |     ldi	r2,2
83fc : 9596     |     add	sp,sp,r2
83fe : 9401     |     mov	r1,r0
     :          | L6_kalloc:
8400 : 9546     |     mov	sp, bp
8402 : c005     |     pop	bp
8404 : c007     |     pop	pc
     :          | _kalloc:
8406 : be01     |     push	r1
8408 : be05     |     push	bp
840a : 9585     |     mov	bp, sp
840c : 0084     |     ldi	r4, 16
840e : 97a6     |     sub	sp, sp, r4
8410 : 0c02     |     la16	r2,_findfreepg ; jaddr
8412 : bd05     |     
8414 : a279     |     addi	r1,pc,2
8416 : c202     |     br.r	r2
8418 : 9444     |     mov	r4,r1
841a : 8dfb     |     stw	-2(bp),r4
841c : 89fb     |     ldw	r4,-2(bp)
841e : 8de3     |     stw	-8(bp),r4
8420 : 0083     |     ld16	r3, 16
8422 : 8dda     |     stw	-10(bp),r3
8424 : be04     |     push r4
8426 : be03     |     push r3
8428 : a279     |     addi r1, pc, 2
842a : 2472     |     br _div
842c : 8df0     |     stw	-4(bp),r1
842e : 000c     |     ld16	r4, 1
8430 : 8dc3     |     stw	-16(bp),r4
8432 : 007b     |     ld16	r3, 15
8434 : 8dca     |     stw	-14(bp),r3
8436 : 89e1     |     ldw	r2,-8(bp)
8438 : 8dd1     |     stw	-12(bp),r2
843a : 89d8     |     ldw	r1,-10(bp)
843c : be02     |     push r2
843e : be01     |     push r1
8440 : a279     |     addi r1, pc, 2
8442 : 249a     |     br _mod
8444 : 89cb     |     ldw	r4,-14(bp)
8446 : 970c     |     sub	r4,r4,r1
8448 : 89c2     |     ldw	r3,-16(bp)
844a : dee4     |     shl.r	r4, r3, r4
844c : 9624     |     sub	r4,r0,r4
844e : a424     |     subi	r4,r4,1
8450 : 8deb     |     stw	-6(bp),r4
8452 : 89f3     |     ldw	r4,-4(bp)
8454 : da33     |     shl	r4, r4, 1
8456 : 0573     |     la16	r3,_pframe
8458 : bd16     |     
845a : 951c     |     add	r4,r4,r3
845c : b023     |     ldw	r3,r0(r4)
845e : 89e9     |     ldw	r2,-6(bp)
8460 : 98d3     |     and	r3,r3,r2
8462 : b423     |     stw	r0(r4),r3
8464 : 89fb     |     ldw	r4,-2(bp)
8466 : be04     |     push	r4
8468 : 0bb4     |     la16	r4,L2_kalloc1
846a : bd13     |     
846c : be04     |     push	r4
846e : 07e2     |     la16	r2,_kprintf
8470 : bd01     |     
8472 : a279     |     addi	r1,pc,2
8474 : c202     |     br.r	r2
8476 : 0022     |     ldi	r2,4
8478 : 9596     |     add	sp,sp,r2
847a : 89fb     |     ldw	r4,-2(bp)
847c : 9501     |     mov	r1,r4
     :          | L2_kalloc0:
847e : 9546     |     mov	sp, bp
8480 : c005     |     pop	bp
8482 : c007     |     pop	pc
     :          | _initpag:
8484 : be01     |     push	r1
8486 : be05     |     push	bp
8488 : 9585     |     mov	bp, sp
848a : 0a62     |     la16	r2,_initkmem
848c : bd05     |     
848e : a279     |     addi	r1,pc,2
8490 : c202     |     br.r	r2
     :          | L1_vm:
8492 : 9546     |     mov	sp, bp
8494 : c005     |     pop	bp
8496 : c007     |     pop	pc
     :          | _setupkvm:
8498 : be01     |     push	r1
849a : be05     |     push	bp
849c : 9585     |     mov	bp, sp
849e : 0014     |     ldi	r4, 2
84a0 : 97a6     |     sub	sp, sp, r4
84a2 : 8813     |     ldw	r4,4(bp)
84a4 : be04     |     push	r4
84a6 : 0db4     |     la16	r4,L3_vm
84a8 : bd13     |     
84aa : be04     |     push	r4
84ac : 07e2     |     la16	r2,_kprintf
84ae : bd01     |     
84b0 : a279     |     addi	r1,pc,2
84b2 : c202     |     br.r	r2
84b4 : 0022     |     ldi	r2,4
84b6 : 9596     |     add	sp,sp,r2
84b8 : 91f8     |     stw	-2(bp),r0
     :          | L4_vm:
84ba : 89fb     |     ldw	r4,-2(bp)
84bc : db12     |     shl	r3, r4, 8
84be : a81b     |     ori	r3,r3,1
84c0 : be03     |     push	r3
84c2 : 8812     |     ldw	r3,4(bp)
84c4 : 94e4     |     add	r4,r3,r4
84c6 : 0083     |     ld16	r3, 16
84c8 : 951c     |     add	r4,r4,r3
84ca : be04     |     push	r4
84cc : 0772     |     la16	r2,_writepte
84ce : bd05     |     
84d0 : a279     |     addi	r1,pc,2
84d2 : c202     |     br.r	r2
84d4 : 0022     |     ldi	r2,4
84d6 : 9596     |     add	sp,sp,r2
     :          | L5_vm:
84d8 : 89fb     |     ldw	r4,-2(bp)
84da : a224     |     addi	r4,r4,1
84dc : 8dfb     |     stw	-2(bp),r4
84de : 89fb     |     ldw	r4,-2(bp)
84e0 : 0073     |     ld16	r3, 14
84e2 : 9d1c     |     skip.gt	r4,r3
84e4 : 3fd4     |     br	L4_vm
84e6 : 881b     |     ldw	r4,6(bp)
84e8 : db13     |     shl	r4, r4, 8
84ea : 001b     |     ld16	r3, 3
84ec : 9b1c     |     or	r4,r4,r3
84ee : be04     |     push	r4
84f0 : 8813     |     ldw	r4,4(bp)
84f2 : 00fb     |     ld16	r3, 31
84f4 : 951c     |     add	r4,r4,r3
84f6 : be04     |     push	r4
84f8 : 0772     |     la16	r2,_writepte
84fa : bd05     |     
84fc : a279     |     addi	r1,pc,2
84fe : c202     |     br.r	r2
8500 : 0022     |     ldi	r2,4
8502 : 9596     |     add	sp,sp,r2
     :          | L2_vm:
8504 : 9546     |     mov	sp, bp
8506 : c005     |     pop	bp
8508 : c007     |     pop	pc
     :          | _addpage:
850a : be01     |     push	r1
850c : be05     |     push	bp
850e : 9585     |     mov	bp, sp
8510 : 0024     |     ldi	r4, 4
8512 : 97a6     |     sub	sp, sp, r4
8514 : 881b     |     ldw	r4,6(bp)
8516 : 8e1b     |     stb	6(bp),r4
8518 : 0032     |     la16	r2,_kalloc
851a : bd09     |     
851c : a279     |     addi	r1,pc,2
851e : c202     |     br.r	r2
8520 : 9444     |     mov	r4,r1
8522 : 8dfb     |     stw	-2(bp),r4
8524 : 89fb     |     ldw	r4,-2(bp)
8526 : db13     |     shl	r4, r4, 8
8528 : 8a1a     |     ldb	r3,6(bp)
852a : 9b1c     |     or	r4,r4,r3
852c : 8df3     |     stw	-4(bp),r4
852e : 89f3     |     ldw	r4,-4(bp)
8530 : be04     |     push	r4
8532 : 8813     |     ldw	r4,4(bp)
8534 : be04     |     push	r4
8536 : 0772     |     la16	r2,_writepte
8538 : bd05     |     
853a : a279     |     addi	r1,pc,2
853c : c202     |     br.r	r2
853e : 0022     |     ldi	r2,4
8540 : 9596     |     add	sp,sp,r2
8542 : 89f8     |     ldw	r1,-2(bp)
     :          | L8_vm:
8544 : 9546     |     mov	sp, bp
8546 : c005     |     pop	bp
8548 : c007     |     pop	pc
     :          | _inituvm:
854a : be01     |     push	r1
854c : be05     |     push	bp
854e : 9585     |     mov	bp, sp
8550 : 0014     |     ldi	r4, 2
8552 : 97a6     |     sub	sp, sp, r4
8554 : 0032     |     la16	r2,_kalloc
8556 : bd09     |     
8558 : a279     |     addi	r1,pc,2
855a : c202     |     br.r	r2
855c : 9444     |     mov	r4,r1
855e : 8dfb     |     stw	-2(bp),r4
8560 : 89fb     |     ldw	r4,-2(bp)
8562 : db13     |     shl	r4, r4, 8
8564 : a824     |     ori	r4,r4,1
8566 : be04     |     push	r4
8568 : be00     |     push	r0
856a : 0772     |     la16	r2,_writepte
856c : bd05     |     
856e : a279     |     addi	r1,pc,2
8570 : c202     |     br.r	r2
8572 : 0022     |     ldi	r2,4
8574 : 9596     |     add	sp,sp,r2
8576 : 89fb     |     ldw	r4,-2(bp)
8578 : db13     |     shl	r4, r4, 8
857a : a824     |     ori	r4,r4,1
857c : be04     |     push	r4
857e : 8813     |     ldw	r4,4(bp)
8580 : be04     |     push	r4
8582 : 0772     |     la16	r2,_writepte
8584 : bd05     |     
8586 : a279     |     addi	r1,pc,2
8588 : c202     |     br.r	r2
858a : 0022     |     ldi	r2,4
858c : 9596     |     add	sp,sp,r2
858e : 00b4     |     ld16	r4, 22
8590 : be04     |     push	r4
8592 : 881b     |     ldw	r4,6(bp)
8594 : be04     |     push	r4
8596 : be00     |     push	r0
8598 : 0922     |     la16	r2,_memmove
859a : bd05     |     
859c : a279     |     addi	r1,pc,2
859e : c202     |     br.r	r2
85a0 : 0032     |     ldi	r2,6
85a2 : 9596     |     add	sp,sp,r2
     :          | L9_vm:
85a4 : 9546     |     mov	sp, bp
85a6 : c005     |     pop	bp
85a8 : c007     |     pop	pc
     :          | _pinit:
85aa : be01     |     push	r1
85ac : be05     |     push	bp
85ae : 9585     |     mov	bp, sp
85b0 : 0024     |     ldi	r4, 4
85b2 : 97a6     |     sub	sp, sp, r4
85b4 : 000c     |     ld16	r4, 1
85b6 : 8df3     |     stw	-4(bp),r4
85b8 : 0c34     |     ld16	r4, 390
85ba : be04     |     push	r4
85bc : be00     |     push	r0
85be : 06b4     |     la16	r4,_ptable
85c0 : bd17     |     
85c2 : be04     |     push	r4
85c4 : 0562     |     la16	r2,_memset
85c6 : bd05     |     
85c8 : a279     |     addi	r1,pc,2
85ca : c202     |     br.r	r2
85cc : 0032     |     ldi	r2,6
85ce : 9596     |     add	sp,sp,r2
85d0 : 06b4     |     la16	r4,_ptable
85d2 : bd17     |     
85d4 : 8dfb     |     stw	-2(bp),r4
85d6 : 0fa4     |     la16	r4,L5_proc
85d8 : bd0b     |     
85da : c204     |     br.r r4
     :          | L2_proc:
85dc : 89fb     |     ldw	r4,-2(bp)
85de : a264     |     addi	r4,r4,2
85e0 : 89f2     |     ldw	r3,-4(bp)
85e2 : daae     |     shl	r3, r3, 5
85e4 : b423     |     stw	r0(r4),r3
85e6 : 89f3     |     ldw	r4,-4(bp)
85e8 : a224     |     addi	r4,r4,1
85ea : 8df3     |     stw	-4(bp),r4
     :          | L3_proc:
85ec : 89fb     |     ldw	r4,-2(bp)
85ee : 00d3     |     ld16	r3, 26
85f0 : 951c     |     add	r4,r4,r3
85f2 : 8dfb     |     stw	-2(bp),r4
     :          | L5_proc:
85f4 : 89fb     |     ldw	r4,-2(bp)
85f6 : 02e3     |     la16	r3,_ptable+390
85f8 : bd1a     |     
85fa : 9ce7     |     skip.ulte	r3,r4
85fc : 3fde     |     br	L2_proc
85fe : 06b4     |     la16	r4,_ptable
8600 : bd17     |     
8602 : be04     |     push	r4
8604 : 024c     |     la16	r4,L7_proc
8606 : bd17     |     
8608 : be04     |     push	r4
860a : 07e2     |     la16	r2,_kprintf
860c : bd01     |     
860e : a279     |     addi	r1,pc,2
8610 : c202     |     br.r	r2
8612 : 0022     |     ldi	r2,4
8614 : 9596     |     add	sp,sp,r2
8616 : 0674     |     la16	r4,_nextpid
8618 : bd17     |     
861a : b420     |     stw	r0(r4),r0
     :          | L1_proc:
861c : 9546     |     mov	sp, bp
861e : c005     |     pop	bp
8620 : c007     |     pop	pc
     :          | _allocproc:
8622 : be01     |     push	r1
8624 : be05     |     push	bp
8626 : 9585     |     mov	bp, sp
8628 : 0024     |     ldi	r4, 4
862a : 97a6     |     sub	sp, sp, r4
862c : 06b4     |     la16	r4,_ptable
862e : bd17     |     
8630 : 8dfb     |     stw	-2(bp),r4
8632 : 0284     |     la16	r4,L1_proc2
8634 : bd0f     |     
8636 : c204     |     br.r r4
     :          | L9_proc:
8638 : 89fb     |     ldw	r4,-2(bp)
863a : a2e4     |     addi	r4,r4,8
863c : b024     |     ldw	r4,r0(r4)
863e : 9d00     |     skip.eq r4,r0
8640 : 2006     |     br L1_proc4
8642 : 03a4     |     la16	r4,L1_proc6
8644 : bd0f     |     
8646 : c204     |     br.r r4
     :          | L1_proc4:
8648 : 89fb     |     ldw	r4,-2(bp)
864a : 00d3     |     ld16	r3, 26
864c : 951c     |     add	r4,r4,r3
864e : 8dfb     |     stw	-2(bp),r4
     :          | L1_proc2:
8650 : 89fb     |     ldw	r4,-2(bp)
8652 : 03b3     |     la16	r3,_ptable+416
8654 : bd1a     |     
8656 : 9ce7     |     skip.ulte	r3,r4
8658 : 3fde     |     br	L9_proc
865a : 012c     |     la16	r4,L1_proc7
865c : bd17     |     
865e : be04     |     push	r4
8660 : 07e2     |     la16	r2,_kprintf
8662 : bd01     |     
8664 : a279     |     addi	r1,pc,2
8666 : c202     |     br.r	r2
8668 : 0012     |     ldi	r2,2
866a : 9596     |     add	sp,sp,r2
866c : 0732     |     la16	r2,_halt
866e : bd05     |     
8670 : a279     |     addi	r1,pc,2
8672 : c202     |     br.r	r2
     :          | L1_proc6:
8674 : 89fb     |     ldw	r4,-2(bp)
8676 : a264     |     addi	r4,r4,2
8678 : b024     |     ldw	r4,r0(r4)
867a : be04     |     push	r4
867c : 006c     |     la16	r4,L1_proc8
867e : bd17     |     
8680 : be04     |     push	r4
8682 : 07e2     |     la16	r2,_kprintf
8684 : bd01     |     
8686 : a279     |     addi	r1,pc,2
8688 : c202     |     br.r	r2
868a : 0022     |     ldi	r2,4
868c : 9596     |     add	sp,sp,r2
868e : 001c     |     ld16	r4, 3
8690 : be04     |     push	r4
8692 : 00f4     |     ld16	r4, 30
8694 : be04     |     push	r4
8696 : 0852     |     la16	r2,_addpage
8698 : bd09     |     
869a : a279     |     addi	r1,pc,2
869c : c202     |     br.r	r2
869e : 0022     |     ldi	r2,4
86a0 : 9596     |     add	sp,sp,r2
86a2 : 89fa     |     ldw	r3,-2(bp)
86a4 : 0032     |     ld16	r2, 6
86a6 : 94d3     |     add	r3,r3,r2
86a8 : 9444     |     mov	r4,r1
86aa : b41c     |     stw	r0(r3),r4
86ac : 89fb     |     ldw	r4,-2(bp)
86ae : a2e4     |     addi	r4,r4,8
86b0 : 000b     |     ld16	r3, 1
86b2 : b423     |     stw	r0(r4),r3
86b4 : 89fb     |     ldw	r4,-2(bp)
86b6 : 0053     |     ld16	r3, 10
86b8 : 951c     |     add	r4,r4,r3
86ba : 0673     |     la16	r3,_nextpid
86bc : bd16     |     
86be : b01b     |     ldw	r3,r0(r3)
86c0 : b423     |     stw	r0(r4),r3
86c2 : 0674     |     la16	r4,_nextpid
86c4 : bd17     |     
86c6 : b023     |     ldw	r3,r0(r4)
86c8 : a21b     |     addi	r3,r3,1
86ca : b423     |     stw	r0(r4),r3
86cc : 0804     |     ld16	r4, 0xf700
86ce : bdef     |     
86d0 : 8df3     |     stw	-4(bp),r4
86d2 : 89f3     |     ldw	r4,-4(bp)
86d4 : 1f83     |     ld16	r3, -16
86d6 : 951c     |     add	r4,r4,r3
86d8 : 8df3     |     stw	-4(bp),r4
86da : 89fb     |     ldw	r4,-2(bp)
86dc : 0063     |     ld16	r3, 12
86de : 951c     |     add	r4,r4,r3
86e0 : 89f2     |     ldw	r3,-4(bp)
86e2 : 0002     |     ld16	r2, 2048
86e4 : bc11     |     
86e6 : 94d3     |     add	r3,r3,r2
86e8 : b423     |     stw	r0(r4),r3
86ea : 89f3     |     ldw	r4,-4(bp)
86ec : a3a4     |     addi	r4,r4,-2
86ee : 8df3     |     stw	-4(bp),r4
86f0 : 89f3     |     ldw	r4,-4(bp)
86f2 : 0ef3     |     la16	r3,_cntxret
86f4 : bd0e     |     
86f6 : b423     |     stw	r0(r4),r3
86f8 : 89f3     |     ldw	r4,-4(bp)
86fa : a3a4     |     addi	r4,r4,-2
86fc : 8df3     |     stw	-4(bp),r4
86fe : 89fb     |     ldw	r4,-2(bp)
8700 : a2a4     |     addi	r4,r4,4
8702 : 89f2     |     ldw	r3,-4(bp)
8704 : 0002     |     ld16	r2, 2048
8706 : bc11     |     
8708 : 94d3     |     add	r3,r3,r2
870a : b423     |     stw	r0(r4),r3
870c : 89f8     |     ldw	r1,-2(bp)
     :          | L8_proc:
870e : 9546     |     mov	sp, bp
8710 : c005     |     pop	bp
8712 : c007     |     pop	pc
     :          | _userinit:
8714 : be01     |     push	r1
8716 : be05     |     push	bp
8718 : 9585     |     mov	bp, sp
871a : 0024     |     ldi	r4, 4
871c : 97a6     |     sub	sp, sp, r4
871e : 0112     |     la16	r2,_allocproc ; jaddr
8720 : bd0d     |     
8722 : a279     |     addi	r1,pc,2
8724 : c202     |     br.r	r2
8726 : 8df8     |     stw	-2(bp),r1
8728 : 89fb     |     ldw	r4,-2(bp)
872a : 0033     |     ld16	r3, 6
872c : 951b     |     add	r3,r4,r3
872e : b01b     |     ldw	r3,r0(r3)
8730 : be03     |     push	r3
8732 : a264     |     addi	r4,r4,2
8734 : b024     |     ldw	r4,r0(r4)
8736 : be04     |     push	r4
8738 : 04c2     |     la16	r2,_setupkvm
873a : bd09     |     
873c : a279     |     addi	r1,pc,2
873e : c202     |     br.r	r2
8740 : 0022     |     ldi	r2,4
8742 : 9596     |     add	sp,sp,r2
8744 : 0a44     |     la16	r4,_initcodestart
8746 : bd13     |     
8748 : be04     |     push	r4
874a : 89fb     |     ldw	r4,-2(bp)
874c : a264     |     addi	r4,r4,2
874e : b024     |     ldw	r4,r0(r4)
8750 : be04     |     push	r4
8752 : 0a52     |     la16	r2,_inituvm
8754 : bd09     |     
8756 : a279     |     addi	r1,pc,2
8758 : c202     |     br.r	r2
875a : 0022     |     ldi	r2,4
875c : 9596     |     add	sp,sp,r2
875e : 0784     |     ld16	r4, 0xf6f0
8760 : bdef     |     
8762 : 8df3     |     stw	-4(bp),r4
8764 : 89f3     |     ldw	r4,-4(bp)
8766 : a2e4     |     addi	r4,r4,8
8768 : 0003     |     ld16	r3, 2048
876a : bc12     |     
876c : b423     |     stw	r0(r4),r3
876e : 89f3     |     ldw	r4,-4(bp)
8770 : 0053     |     ld16	r3, 10
8772 : 951c     |     add	r4,r4,r3
8774 : 0003     |     ld16	r3, 2048
8776 : bc12     |     
8778 : b423     |     stw	r0(r4),r3
877a : 89f3     |     ldw	r4,-4(bp)
877c : 0063     |     ld16	r3, 12
877e : 951c     |     add	r4,r4,r3
8780 : b420     |     stw	r0(r4),r0
8782 : 89f3     |     ldw	r4,-4(bp)
8784 : 0073     |     ld16	r3, 14
8786 : 951c     |     add	r4,r4,r3
8788 : 0063     |     ld16	r3, 12
878a : b423     |     stw	r0(r4),r3
878c : 89fb     |     ldw	r4,-2(bp)
878e : a2e4     |     addi	r4,r4,8
8790 : 001b     |     ld16	r3, 3
8792 : b423     |     stw	r0(r4),r3
8794 : 0f24     |     la16	r4,L2_proc0
8796 : bd13     |     
8798 : be04     |     push	r4
879a : 07e2     |     la16	r2,_kprintf
879c : bd01     |     
879e : a279     |     addi	r1,pc,2
87a0 : c202     |     br.r	r2
87a2 : 0012     |     ldi	r2,2
87a4 : 9596     |     add	sp,sp,r2
87a6 : 0742     |     la16	r2,_breek
87a8 : bd05     |     
87aa : a279     |     addi	r1,pc,2
87ac : c202     |     br.r	r2
87ae : 89fb     |     ldw	r4,-2(bp)
87b0 : a2a3     |     addi	r3,r4,4
87b2 : b01b     |     ldw	r3,r0(r3)
87b4 : be03     |     push	r3
87b6 : a264     |     addi	r4,r4,2
87b8 : b024     |     ldw	r4,r0(r4)
87ba : be04     |     push	r4
87bc : 0684     |     la16	r4,_sched
87be : bd17     |     
87c0 : be04     |     push	r4
87c2 : 0002     |     la16	r2,_swtch
87c4 : bd11     |     
87c6 : a279     |     addi	r1,pc,2
87c8 : c202     |     br.r	r2
87ca : 0032     |     ldi	r2,6
87cc : 9596     |     add	sp,sp,r2
     :          | L1_proc9:
87ce : 9546     |     mov	sp, bp
87d0 : c005     |     pop	bp
87d2 : c007     |     pop	pc
     :          | _alltraps:
87d4 : 0103     |     ldi r3, 0x20
87d6 : 985c     |     and r4, r1, r3
87d8 : 9d18     |     skip.eq r4, r3
87da : 2016     |     br simpletrap_trapasm
87dc : fe00     |     hlt
     :          | _cntxret:
87de : e201     |     pop.u r1
87e0 : e202     |     pop.u r2
87e2 : e203     |     pop.u r3
87e4 : e204     |     pop.u r4
87e6 : e205     |     pop.u bp
87e8 : e206     |     pop.u sp
87ea : e207     |     pop.u pc
87ec : c001     |     pop r1
87ee : e640     |     wcr.u r1
87f0 : c600     |     reti
     :          | simpletrap_trapasm:
87f2 : c806     |     push.u sp
87f4 : be01     |     push r1 	;trapnr
87f6 : 00b3     |     la16 r3, _trap
87f8 : bd12     |     
87fa : a279     |     addi r1, pc, 2
87fc : c203     |     br.r r3
     :          | trapret_trapasm:
87fe : c600     |     reti
     :          | _swtch:
8800 : be01     |     push r1
8802 : be05     |     push bp
8804 : 9585     |     mov bp, sp
8806 : 8810     |     ldw r1, 4(bp) ; sched->context (to save SP)
8808 : 8819     |     ldw r2, 6(bp) ; ptb
880a : 8822     |     ldw r3, 8(bp) ; context (= new SP)
880c : b40e     |     stw r0(r1), sp  ; store old sp in sched->context
880e : d480     |     wptb r2					; switch to new address space
8810 : 94c6     |     mov sp, r3      ; switch sp to new stack bottom
8812 : c005     |     pop bp
8814 : c007     |     pop pc
     :          | _trap:
8816 : be01     |     push	r1
8818 : be05     |     push	bp
881a : 9585     |     mov	bp, sp
881c : 881b     |     ldw	r4,6(bp)
881e : be04     |     push	r4
8820 : 8813     |     ldw	r4,4(bp)
8822 : be04     |     push	r4
8824 : 03bc     |     la16	r4,L2_trap
8826 : bd17     |     
8828 : be04     |     push	r4
882a : 07e2     |     la16	r2,_kprintf
882c : bd01     |     
882e : a279     |     addi	r1,pc,2
8830 : c202     |     br.r	r2
8832 : 0032     |     ldi	r2,6
8834 : 9596     |     add	sp,sp,r2
8836 : 8813     |     ldw	r4,4(bp)
8838 : 0083     |     ld16	r3, 16
883a : 9d18     |     skip.eq r4,r3
883c : 2012     |     br L3_trap
883e : 0374     |     la16	r4,L5_trap
8840 : bd17     |     
8842 : be04     |     push	r4
8844 : 07e2     |     la16	r2,_kprintf
8846 : bd01     |     
8848 : a279     |     addi	r1,pc,2
884a : c202     |     br.r	r2
884c : 0012     |     ldi	r2,2
884e : 9596     |     add	sp,sp,r2
     :          | L3_trap:
8850 : 0742     |     la16	r2,_breek
8852 : bd05     |     
8854 : a279     |     addi	r1,pc,2
8856 : c202     |     br.r	r2
     :          | L1_trap:
8858 : 9546     |     mov	sp, bp
885a : c005     |     pop	bp
885c : c007     |     pop	pc
     :          | _kmain:
885e : be01     |     push	r1
8860 : be05     |     push	bp
8862 : 9585     |     mov	bp, sp
8864 : 0454     |     la16	r4,L2_kmain
8866 : bd17     |     
8868 : be04     |     push	r4
886a : 07e2     |     la16	r2,_kprintf
886c : bd01     |     
886e : a279     |     addi	r1,pc,2
8870 : c202     |     br.r	r2
8872 : 0012     |     ldi	r2,2
8874 : 9596     |     add	sp,sp,r2
8876 : 0a62     |     la16	r2,_initkmem
8878 : bd05     |     
887a : a279     |     addi	r1,pc,2
887c : c202     |     br.r	r2
887e : 0d52     |     la16	r2,_pinit
8880 : bd09     |     
8882 : a279     |     addi	r1,pc,2
8884 : c202     |     br.r	r2
8886 : 08a2     |     la16	r2,_userinit
8888 : bd0d     |     
888a : a279     |     addi	r1,pc,2
888c : c202     |     br.r	r2
888e : 0732     |     la16	r2,_halt
8890 : bd05     |     
8892 : a279     |     addi	r1,pc,2
8894 : c202     |     br.r	r2
8896 : 9401     |     mov	r1,r0
     :          | L1_kmain:
8898 : 9546     |     mov	sp, bp
889a : c005     |     pop	bp
889c : c007     |     pop	pc
     :          | _div:
889e : be01     |     push r1
88a0 : be05     |     push bp
88a2 : 9585     |     mov bp, sp
88a4 : 0082     |     ldi r2, 16
88a6 : 9404     |     mov r4, r0
88a8 : 91f8     |     stw -2(bp), r0
     :          | divL1_pseudo_ops:
88aa : a412     |     subi r2, r2, 1
88ac : da33     |     shl r4,r4,1
88ae : 0ff1     |     ld16 r1, 0xfffe
88b0 : bdfc     |     
88b2 : 990c     |     and r4, r4, r1
88b4 : 0009     |     ldi r1, 1
88b6 : de51     |     shl.r r1, r1, r2
88b8 : 881a     |     ldw r3, 6(bp)
88ba : 98c9     |     and r1, r3, r1
88bc : e051     |     shr.r r1, r1, r2
88be : 9b0c     |     or r4, r4, r1
88c0 : 8812     |     ldw r3, 4(bp)
88c2 : 9ce7     |     skip.ulte r3, r4
88c4 : 200c     |     br divL2_pseudo_ops
88c6 : 971c     |     sub r4, r4, r3
88c8 : 0009     |     ldi r1, 1
88ca : de51     |     shl.r r1, r1, r2
88cc : 89fa     |     ldw r3, -2(bp)
88ce : 9acb     |     or r3, r3, r1
88d0 : 8dfa     |     stw -2(bp), r3
     :          | divL2_pseudo_ops:
88d2 : 9c80     |     skip.eq r2, r0
88d4 : 3fd4     |     br divL1_pseudo_ops
88d6 : 89f8     |     ldw r1, -2(bp)
88d8 : 9546     |     mov	sp, bp
88da : c005     |     pop	bp
88dc : c007     |     pop	pc
     :          | _mod:
88de : be01     |     push r1
88e0 : be05     |     push bp
88e2 : 9585     |     mov bp, sp
88e4 : 0082     |     ldi r2, 16
88e6 : 9404     |     mov r4, r0
88e8 : 91f8     |     stw -2(bp), r0
     :          | modL1_pseudo_ops:
88ea : a412     |     subi r2, r2, 1
88ec : da33     |     shl r4,r4,1
88ee : 0ff1     |     ld16 r1, 0xfffe
88f0 : bdfc     |     
88f2 : 990c     |     and r4, r4, r1
88f4 : 0009     |     ldi r1, 1
88f6 : de51     |     shl.r r1, r1, r2
88f8 : 881a     |     ldw r3, 6(bp)
88fa : 98c9     |     and r1, r3, r1
88fc : e051     |     shr.r r1, r1, r2
88fe : 9b0c     |     or r4, r4, r1
8900 : 8812     |     ldw r3, 4(bp)
8902 : 9ce7     |     skip.ulte r3, r4
8904 : 200c     |     br modL2_pseudo_ops
8906 : 971c     |     sub r4, r4, r3
8908 : 0009     |     ldi r1, 1
890a : de51     |     shl.r r1, r1, r2
890c : 89fa     |     ldw r3, -2(bp)
890e : 9acb     |     or r3, r3, r1
8910 : 8dfa     |     stw -2(bp), r3
     :          | modL2_pseudo_ops:
8912 : 9c80     |     skip.eq r2, r0
8914 : 3fd4     |     br modL1_pseudo_ops
8916 : 9501     |     mov r1, r4 ; transfer result to r1
8918 : 9546     |     mov	sp, bp
891a : c005     |     pop	bp
891c : c007     |     pop	pc
     :          | _mult:
891e : c002     |     pop r2 ; op1
8920 : c003     |     pop r3 ; op2
8922 : 9401     |     mov r1, r0 ; result reg
8924 : 9c9c     |     skip.gt r2, r3
8926 : 2006     |     br multL2_pseudo_ops
8928 : 9484     |     mov r4, r2
892a : 94c2     |     mov r2, r3
892c : 9503     |     mov r3, r4
     :          | multL2_pseudo_ops:
892e : 000c     |     ldi r4, 1
8930 : 9ca4     |     skip.gt r2, r4
8932 : 200c     |     br multL3_pseudo_ops
8934 : a614     |     andi r4, r2, 1
8936 : afe4     |     addskpi.nz r4, r4, -1
8938 : 9459     |     add r1, r1, r3
893a : dc29     |     shr r2, r2, 1
893c : da2e     |     shl r3, r3, 1
893e : 3fee     |     br multL2_pseudo_ops
     :          | multL3_pseudo_ops:
8940 : a60c     |     andi r4, r1, 1
8942 : afe4     |     addskpi.nz r4, r4, -1
8944 : 9459     |     add r1, r1, r3
8946 : c205     |     br.r bp;  Initial process execs /init.
     :          | _initcodestart:
8948 : 0551     |     la16 r1, L2_initcode
894a : bd14     |     
894c : be01     |     push r1
894e : 0511     |     la16 r1, L1_initcode
8950 : bd14     |     
8952 : be01     |     push r1
8954 : be00     |     push r0    ; where caller pc would be
8956 : 0039     |     ldi r1, 7 ; syscall 7 = exec
8958 : be01     |     push r1
895a : c400     |     syscall
895c : fe00     |     hlt
     :          | L2_console:
895e : 3031     |     defb 48
8960 : 3233     |     defb 50
8962 : 3435     |     defb 52
8964 : 3637     |     defb 54
8966 : 3839     |     defb 56
8968 : 6162     |     defb 97
896a : 6364     |     defb 99
896c : 6566     |     defb 101
896e : 0028     |     defb 0
8970 : 6e75     |     defb 110
8972 : 6c6c     |     defb 108
8974 : 2900     |     defb 41
     :          | L2_kalloc1:
8976 : 6b61     |     defb 107
8978 : 6c6c     |     defb 108
897a : 6f63     |     defb 111
897c : 3a20     |     defb 58
897e : 616c     |     defb 97
8980 : 6c6f     |     defb 108
8982 : 6361     |     defb 99
8984 : 7465     |     defb 116
8986 : 6420     |     defb 100
8988 : 7061     |     defb 112
898a : 6765     |     defb 103
898c : 3a20     |     defb 58
898e : 2564     |     defb 37
8990 : 0a00     |     defb 10
     :          | L1_kalloc9:
8992 : 4669     |     defb 70
8994 : 6e64     |     defb 110
8996 : 6672     |     defb 102
8998 : 6565     |     defb 101
899a : 7067     |     defb 112
899c : 3a20     |     defb 58
899e : 4e4f     |     defb 78
89a0 : 2046     |     defb 32
89a2 : 5245     |     defb 82
89a4 : 4520     |     defb 69
89a6 : 5041     |     defb 80
89a8 : 4745     |     defb 71
89aa : 2046     |     defb 32
89ac : 4f55     |     defb 79
89ae : 4e44     |     defb 78
89b0 : 210a     |     defb 33
89b2 : 0000     |     defb 0
     :          | _kptb:
89b4 : 0000     |     defw 0x0
     :          | L3_vm:
89b6 : 7365     |     defb 115
89b8 : 7475     |     defb 116
89ba : 706b     |     defb 112
89bc : 766d     |     defb 118
89be : 3a20     |     defb 58
89c0 : 6275     |     defb 98
89c2 : 696c     |     defb 105
89c4 : 6469     |     defb 100
89c6 : 6e67     |     defb 110
89c8 : 2061     |     defb 32
89ca : 6464     |     defb 100
89cc : 7265     |     defb 114
89ce : 7373     |     defb 115
89d0 : 2073     |     defb 32
89d2 : 7061     |     defb 112
89d4 : 6365     |     defb 99
89d6 : 2066     |     defb 32
89d8 : 6f72     |     defb 111
89da : 2070     |     defb 32
89dc : 7462     |     defb 116
89de : 3a20     |     defb 58
89e0 : 2564     |     defb 37
89e2 : 0a00     |     defb 10
     :          | L2_proc0:
89e4 : 7573     |     defb 117
89e6 : 6572     |     defb 101
89e8 : 696e     |     defb 105
89ea : 6974     |     defb 105
89ec : 3a20     |     defb 58
89ee : 7374     |     defb 115
89f0 : 6172     |     defb 97
89f2 : 7469     |     defb 116
89f4 : 6e67     |     defb 110
89f6 : 2066     |     defb 32
89f8 : 6972     |     defb 105
89fa : 7374     |     defb 115
89fc : 2075     |     defb 32
89fe : 7365     |     defb 115
8a00 : 7220     |     defb 114
8a02 : 7072     |     defb 112
8a04 : 6f63     |     defb 111
8a06 : 6573     |     defb 101
8a08 : 732e     |     defb 115
8a0a : 2e0a     |     defb 46
8a0c : 0066     |     defb 0
8a0e : 6f75     |     defb 111
8a10 : 6e64     |     defb 110
8a12 : 2066     |     defb 32
8a14 : 7265     |     defb 114
8a16 : 6520     |     defb 101
8a18 : 736c     |     defb 115
8a1a : 6f74     |     defb 111
8a1c : 2061     |     defb 32
8a1e : 743a     |     defb 116
8a20 : 2025     |     defb 32
8a22 : 640a     |     defb 100
8a24 : 0061     |     defb 0
8a26 : 6c6c     |     defb 108
8a28 : 6f63     |     defb 111
8a2a : 7072     |     defb 112
8a2c : 6f63     |     defb 111
8a2e : 3a20     |     defb 58
8a30 : 6e6f     |     defb 110
8a32 : 2066     |     defb 32
8a34 : 7265     |     defb 114
8a36 : 6520     |     defb 101
8a38 : 736c     |     defb 115
8a3a : 6f74     |     defb 111
8a3c : 2069     |     defb 32
8a3e : 6e20     |     defb 110
8a40 : 7074     |     defb 112
8a42 : 6162     |     defb 97
8a44 : 6c65     |     defb 108
8a46 : 210a     |     defb 33
8a48 : 0070     |     defb 0
8a4a : 696e     |     defb 105
8a4c : 6974     |     defb 105
8a4e : 3a20     |     defb 58
8a50 : 7074     |     defb 112
8a52 : 6162     |     defb 97
8a54 : 6c65     |     defb 108
8a56 : 2069     |     defb 32
8a58 : 6e69     |     defb 110
8a5a : 7469     |     defb 116
8a5c : 616c     |     defb 97
8a5e : 6973     |     defb 105
8a60 : 6564     |     defb 101
8a62 : 2061     |     defb 32
8a64 : 743a     |     defb 116
8a66 : 2030     |     defb 32
8a68 : 7825     |     defb 120
8a6a : 782e     |     defb 120
8a6c : 0a00     |     defb 10
     :          | L5_trap:
8a6e : 5359     |     defb 83
8a70 : 5343     |     defb 83
8a72 : 414c     |     defb 65
8a74 : 4c21     |     defb 76
8a76 : 0054     |     defb 0
8a78 : 7261     |     defb 114
8a7a : 703a     |     defb 112
8a7c : 2025     |     defb 32
8a7e : 642c     |     defb 100
8a80 : 2075     |     defb 32
8a82 : 5350     |     defb 83
8a84 : 3a20     |     defb 58
8a86 : 2578     |     defb 37
8a88 : 0a00     |     defb 10
     :          | L2_kmain:
8a8a : 444d     |     defb 68
8a8c : 4520     |     defb 69
8a8e : 4f53     |     defb 79
8a90 : 2076     |     defb 32
8a92 : 2564     |     defb 37
8a94 : 2073     |     defb 32
8a96 : 7461     |     defb 116
8a98 : 7274     |     defb 114
8a9a : 696e     |     defb 105
8a9c : 672e     |     defb 103
8a9e : 2e2e     |     defb 46
8aa0 : 0a00     |     defb 10
     :          | L1_initcode:
8aa2 : 2f69     |     defstr "/init\0"
8aa4 : 6e69     |     
8aa6 : 745c     |     
8aa8 : 3000     |     
     :          | L2_initcode:
8aaa : 8aa2     |     defw L1_initcode
8aac : 0000     |     defw 0
     :          | _pframe:
8aae : 0000     |     defs 32
8ab0 : 0000     |     
8ab2 : 0000     |     
8ab4 : 0000     |     
8ab6 : 0000     |     
8ab8 : 0000     |     
8aba : 0000     |     
8abc : 0000     |     
8abe : 0000     |     
8ac0 : 0000     |     
8ac2 : 0000     |     
8ac4 : 0000     |     
8ac6 : 0000     |     
8ac8 : 0000     |     
8aca : 0000     |     
8acc : 0000     |     
     :          | _nextpid:
8ace : 0000     |     defs 2
     :          | _sched:
8ad0 : 0000     |     defs 6
8ad2 : 0000     |     
8ad4 : 0000     |     
     :          | _ptable:
8ad6 : 0000     |     defs 390
8ad8 : 0000     |     
8ada : 0000     |     
8adc : 0000     |     
8ade : 0000     |     
8ae0 : 0000     |     
8ae2 : 0000     |     
8ae4 : 0000     |     
8ae6 : 0000     |     
8ae8 : 0000     |     
8aea : 0000     |     
8aec : 0000     |     
8aee : 0000     |     
8af0 : 0000     |     
8af2 : 0000     |     
8af4 : 0000     |     
8af6 : 0000     |     
8af8 : 0000     |     
8afa : 0000     |     
8afc : 0000     |     
8afe : 0000     |     
8b00 : 0000     |     
8b02 : 0000     |     
8b04 : 0000     |     
8b06 : 0000     |     
8b08 : 0000     |     
8b0a : 0000     |     
8b0c : 0000     |     
8b0e : 0000     |     
8b10 : 0000     |     
8b12 : 0000     |     
8b14 : 0000     |     
8b16 : 0000     |     
8b18 : 0000     |     
8b1a : 0000     |     
8b1c : 0000     |     
8b1e : 0000     |     
8b20 : 0000     |     
8b22 : 0000     |     
8b24 : 0000     |     
8b26 : 0000     |     
8b28 : 0000     |     
8b2a : 0000     |     
8b2c : 0000     |     
8b2e : 0000     |     
8b30 : 0000     |     
8b32 : 0000     |     
8b34 : 0000     |     
8b36 : 0000     |     
8b38 : 0000     |     
8b3a : 0000     |     
8b3c : 0000     |     
8b3e : 0000     |     
8b40 : 0000     |     
8b42 : 0000     |     
8b44 : 0000     |     
8b46 : 0000     |     
8b48 : 0000     |     
8b4a : 0000     |     
8b4c : 0000     |     
8b4e : 0000     |     
8b50 : 0000     |     
8b52 : 0000     |     
8b54 : 0000     |     
8b56 : 0000     |     
8b58 : 0000     |     
8b5a : 0000     |     
8b5c : 0000     |     
8b5e : 0000     |     
8b60 : 0000     |     
8b62 : 0000     |     
8b64 : 0000     |     
8b66 : 0000     |     
8b68 : 0000     |     
8b6a : 0000     |     
8b6c : 0000     |     
8b6e : 0000     |     
8b70 : 0000     |     
8b72 : 0000     |     
8b74 : 0000     |     
8b76 : 0000     |     
8b78 : 0000     |     
8b7a : 0000     |     
8b7c : 0000     |     
8b7e : 0000     |     
8b80 : 0000     |     
8b82 : 0000     |     
8b84 : 0000     |     
8b86 : 0000     |     
8b88 : 0000     |     
8b8a : 0000     |     
8b8c : 0000     |     
8b8e : 0000     |     
8b90 : 0000     |     
8b92 : 0000     |     
8b94 : 0000     |     
8b96 : 0000     |     
8b98 : 0000     |     
8b9a : 0000     |     
8b9c : 0000     |     
8b9e : 0000     |     
8ba0 : 0000     |     
8ba2 : 0000     |     
8ba4 : 0000     |     
8ba6 : 0000     |     
8ba8 : 0000     |     
8baa : 0000     |     
8bac : 0000     |     
8bae : 0000     |     
8bb0 : 0000     |     
8bb2 : 0000     |     
8bb4 : 0000     |     
8bb6 : 0000     |     
8bb8 : 0000     |     
8bba : 0000     |     
8bbc : 0000     |     
8bbe : 0000     |     
8bc0 : 0000     |     
8bc2 : 0000     |     
8bc4 : 0000     |     
8bc6 : 0000     |     
8bc8 : 0000     |     
8bca : 0000     |     
8bcc : 0000     |     
8bce : 0000     |     
8bd0 : 0000     |     
8bd2 : 0000     |     
8bd4 : 0000     |     
8bd6 : 0000     |     
8bd8 : 0000     |     
8bda : 0000     |     
8bdc : 0000     |     
8bde : 0000     |     
8be0 : 0000     |     
8be2 : 0000     |     
8be4 : 0000     |     
8be6 : 0000     |     
8be8 : 0000     |     
8bea : 0000     |     
8bec : 0000     |     
8bee : 0000     |     
8bf0 : 0000     |     
8bf2 : 0000     |     
8bf4 : 0000     |     
8bf6 : 0000     |     
8bf8 : 0000     |     
8bfa : 0000     |     
8bfc : 0000     |     
8bfe : 0000     |     
8c00 : 0000     |     
8c02 : 0000     |     
8c04 : 0000     |     
8c06 : 0000     |     
8c08 : 0000     |     
8c0a : 0000     |     
8c0c : 0000     |     
8c0e : 0000     |     
8c10 : 0000     |     
8c12 : 0000     |     
8c14 : 0000     |     
8c16 : 0000     |     
8c18 : 0000     |     
8c1a : 0000     |     
8c1c : 0000     |     
8c1e : 0000     |     
8c20 : 0000     |     
8c22 : 0000     |     
8c24 : 0000     |     
8c26 : 0000     |     
8c28 : 0000     |     
8c2a : 0000     |     
8c2c : 0000     |     
8c2e : 0000     |     
8c30 : 0000     |     
8c32 : 0000     |     
8c34 : 0000     |     
8c36 : 0000     |     
8c38 : 0000     |     
8c3a : 0000     |     
8c3c : 0000     |     
8c3e : 0000     |     
8c40 : 0000     |     
8c42 : 0000     |     
8c44 : 0000     |     
8c46 : 0000     |     
8c48 : 0000     |     
8c4a : 0000     |     
8c4c : 0000     |     
8c4e : 0000     |     
8c50 : 0000     |     
8c52 : 0000     |     
8c54 : 0000     |     
8c56 : 0000     |     
8c58 : 0000     |     
8c5a : 0000     |     
